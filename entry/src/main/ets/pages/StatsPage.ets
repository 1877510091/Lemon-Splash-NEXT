import router from '@ohos.router';

// âœ… å®šä¹‰ç±»
class MonthData {
  title: string;
  count: number;
  constructor(title: string, count: number) {
    this.title = title;
    this.count = count;
  }
}

@Entry
@Component
struct StatsPage {
  @State expandedIndex: number = -1;
  private months: MonthData[] = [
    new MonthData("2025-12", 120),
    new MonthData("2025-11", 350),
    new MonthData("2025-10", 0)
  ];

  build() {
    Column() {
      Row() {
        SymbolGlyph($r('sys.symbol.chevron_left'))
          .fontSize(24).fontColor(['#2E7D32']) // âœ… ä¿®å¤æ•°ç»„
          .onClick(() => router.back())
        Text("å­¦ä¹ è¶³è¿¹")
          .fontSize(20).fontWeight(FontWeight.Bold).fontColor('#2E7D32')
          .layoutWeight(1).textAlign(TextAlign.Center)
        Blank().width(24)
      }
      .height(56).width('100%').padding({ left: 16, right: 16 })
      .backgroundColor(Color.White)

      if (this.months.length === 0) {
        Column() {
          Text("æš‚æ— è®°å½•ï¼Œå¿«åŽ»èƒŒä¸ªå•è¯å§ï¼").fontColor(Color.Gray)
        }
        .justifyContent(FlexAlign.Center).layoutWeight(1).width('100%')
      } else {
        List({ space: 10 }) {
          ForEach(this.months, (item: MonthData, index: number) => {
            ListItem() {
              Column() {
                Row() {
                  Stack() {
                    Circle({ width: 40, height: 40 }).fill('#F0F4C3')
                    SymbolGlyph($r('sys.symbol.calendar')).fontColor(['#827717']) // âœ… ä¿®å¤æ•°ç»„
                  }.margin({ right: 16 })

                  Text(item.title).fontSize(18).fontWeight(FontWeight.Bold).fontColor('#00695C')
                  Blank()
                  if (item.count > 0) {
                    Text(item.count + "è¯").fontSize(12).fontColor('#558B2F').backgroundColor('#F1F8E9').padding({ left: 8, right: 8, top: 2, bottom: 2 }).borderRadius(8)
                  }

                  SymbolGlyph(this.expandedIndex === index ? $r('sys.symbol.chevron_up') : $r('sys.symbol.chevron_down'))
                    .fontSize(16).fontColor([Color.Gray]).margin({ left: 10 }) // âœ… ä¿®å¤æ•°ç»„
                }
                .width('100%')
                .padding(16)
                .onClick(() => {
                  animateTo({ duration: 300 }, () => {
                    this.expandedIndex = this.expandedIndex === index ? -1 : index;
                  })
                })

                if (this.expandedIndex === index) {
                  Column() {
                    if (item.count > 0) {
                      Text("ðŸ“ˆ æ¯æ—¥å­¦ä¹ è¶‹åŠ¿å›¾").fontSize(12).fontColor('#009688').margin({ bottom: 10 })
                      Row({ space: 5 }) {
                        ForEach([20, 50, 30, 80, 40, 60, 20], (h: number) => {
                          Column().width(10).height(h).backgroundColor('#80CBC4').borderRadius(2)
                        })
                      }.alignItems(VerticalAlign.Bottom).height(100)
                    } else {
                      Text("æœ¬æœˆæ— è®°å½•").fontSize(12).fontColor(Color.Gray)
                    }
                  }
                  .height(150)
                  .width('100%')
                  .backgroundColor('rgba(255,255,255,0.5)')
                  .justifyContent(FlexAlign.Center)
                  .margin({ bottom: 10 })
                }
              }
              .backgroundColor(Color.White)
              .borderRadius(16)
            }
          })
        }
        .layoutWeight(1)
        .padding(20)
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F1F8E9')
    .padding({ top: 10 })
  }
}